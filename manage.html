<!DOCTYPE html>
<html lang="en">
  <head>
  	<meta charset="utf-8">

	<title>Mobanic - Portal</title>
	<link rel="icon" type="image/png" href="img/favicon.png">	
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link href="css/jumbotron-narrow.css" rel="stylesheet">
  	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.4.2.min.js"></script>
  	<script type="text/javascript">
	    Parse.initialize("asQfJUeEXdJnbfvG2iefkvjhVpcmIq2GnOp5x5P2", "nekbtqyfm8m3K6DRekriIij1U3fnxPLGiAq01Nf7");

	    var currentUser = Parse.User.current();
		if (!currentUser) {
		    window.location.replace('index.html');
		}

  	</script>
  </head>

  <body>

  	<div class="container">
  		<div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            <li role="presentation" class="active"><a href="index.html">Portal</a></li>
            <li role="presentation"><a href="http://mobanic.com">Home</a></li>
          </ul>
        </nav>
        <a href="http://mobanic.com"><img src="img/header_logo.png"</img></a>
      
      </div>

    <div class="jumbotron">
    	<div class="row">
		  <div class="col-md-8"><h1 style="font-size: 40px">Manage car listing</h1></div>
		  <div class="col-md-4"><a class="btn btn-success" href="upload.html" role="button">Upload new</a></div>
		</div>
		<br><br>
    	<div class="table-responsive" id="tablePrint"></div>
		
    </div><br>

      <footer class="footer">
        <p class="text-center">Copyright Â© 2015 Mobanic Ltd</p>
      </footer>

      </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script type="text/javascript">
		var CarObject = Parse.Object.extend("Car");
		var query = new Parse.Query(CarObject);
		query.descending("createdAt");
		query.find({
		  success: function(results) {
		  		var myTable= "<table class=\"table table-hover\"><thead><tr><th>#</th><th>Model</th><th>Date</th><th>Actions</th></tr></thead><tbody>";

		  		var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
				  "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
				];

		  		for (var i = 0; i < results.length; i++) {
			      var object = results[i];
			      var date = object.createdAt;
			      myTable+= "<tr><td>" + (i+1) + "</td><td><a href='#' title='Edit'>" + 
			      				object.get('model') + "</td><td>" + 
			      				+ date.getDate() + " " + monthNames[date.getMonth()] + "</td><td>" + 
			      				"<a href='#' title='Mark as sold'><span class='glyphicon glyphicon-eye-close' style='margin-right: 8px; margin-left: 10px'></span></a>" + "<a href='#' title='Delete'><span class='glyphicon glyphicon-remove'></span></a>" + "</a></td></tr>";
			      // alert(object.id + ' - ' + object.get('make'));
			    }
			    myTable+= "</tbody></table>";

			    document.getElementById('tablePrint').innerHTML = myTable;
        	},
		  error: function(error) {
		    alert("Error: " + error.code + " " + error.message);
		  }
		});
	</script>
  </body>
</html>